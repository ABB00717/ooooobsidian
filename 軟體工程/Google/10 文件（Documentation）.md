這是一個極為重要的課題。在 Google 的軟體工程實踐中，文件（Documentation）絕非可有可無的附屬品，而是與代碼本身同等重要的「資產」。

首先，請允許我用一個教學開場白，為您啟動我們對「軟體工程」這門學科的深度探索。

---

## 啟動課程：軟體工程的本質

各位同學，當我們談論軟體工程時，很容易將其窄化為「編程」（Programming）本身。但事實上，軟體工程學所定義的核心領域，遠比單純撰寫代碼要廣闊得多。

**一句話定義核心：** 軟體工程的本質，是將「編程」這個即時的行為，拉長到時間維度上進行的「整合式編程」（"programming integrated over time"）。

**點出核心問題：** 編程解決的是眼前的問題，但軟體工程存在的根本目的，是解決隨著時間推移，如何確保代碼庫的價值與**可持續性**，以應對不斷變化的需求、技術和環境，避免代碼在組織和規模擴大後陷入僵化或崩潰。

**建立支柱：** 為了達成代碼的可持續發展，我們必須圍繞三大核心支柱建立實踐體系：

1. **時間與變化（Time and Change）：** 代碼的預期壽命是數月還是數十年？它將如何適應依賴項的升級、語言版本的迭代以及產品方向的轉變？。
2. **規模與成長（Scale and Growth）：** 如何確保系統、工具和流程能隨著工程師數量和代碼庫體量的指數級增長而保持高效運轉？。
3. **權衡與成本（Trade-Offs and Costs）：** 組織如何在時間和規模的教訓基礎上，做出涉及財務、資源、人力乃至社會影響的複雜決策？。

**串連概念：** 我們在軟體工程中所做的每一個決策，都必須考量代碼的壽命（時間與變化）和組織/代碼庫的體量（規模與成長），然後才能做出最符合長期利益的成本權衡（權衡與成本），共同指向代碼的可持續發展。

在上述框架下，我們來深入探討文件（Documentation）這項關鍵實踐，看看它是如何在 Google 幫助我們解決「時間與規模」帶來的挑戰，並優化「權衡與成本」的。

---

## 軟體工程於 Google：文件（Documentation）深度解析

大多數工程師普遍抱怨缺乏高品質的文件，這是一個普遍存在的痛點。在 Google，我們發現文件撰寫的現狀，類似於 1980 年代晚期的軟體測試：所有人都認可其重要性，但組織上仍缺乏對其關鍵益處的認知和足夠的工具支持。

解決之道在於，將文件視為代碼，並將其納入傳統的工程師工作流程中，使其易於撰寫與維護。

### 1. 何謂文件？（What Qualifies as Documentation?）

文件泛指工程師在工作中需要撰寫的所有補充文本，這不僅包括獨立的文檔，也涵蓋了代碼註釋（Code Comments）。實際上，在 Google 工程師所撰寫的文件中，代碼註釋佔了很大一部分。

### 2. 為何需要文件？（Why Is Documentation Needed?）

高品質文件的好處都是**下游的**，這意味著它們不會立即給作者帶來收益。但如同投資測試一樣，對文件的投入會在時間的維度上帶來回報。文件只撰寫一次，但會被閱讀數百乃至數千次，初始成本會被平攤到未來所有的讀者身上，因此文件能夠隨著時間實現規模化效益，對代碼庫的長期可持續性至關重要。

文件帶來以下關鍵益處：

- **優化 API 設計：** 撰寫文件是檢視 API 設計是否合理的最佳方式。如果無法清晰解釋或定義 API，這通常說明設計本身還不夠完善。
- **提供歷史紀錄：** 文件為維護工作提供了路線圖和歷史紀錄，尤其當工程師在數年後回顧自己撰寫的代碼時，優良的註釋至關重要。
- **樹立專業形象：** 開發人員會傾向於認為文檔完善的 API 擁有更好的設計。產品文檔的好壞，也預示著該產品未來維護情況的優劣。
- **減少重複問答：** 對於作者而言，長遠來看最大的好處是減少了重複回答相似問題的次數。

文件的核心原則是：**為讀者優化（optimize for the reader）**。

### 3. 文件即代碼（Documentation Is Like Code）

文件不應被視為與代碼截然不同的技能，它是一種工具，具備自身的規則、語法和風格，目的與代碼相似：確保一致性、提高清晰度、減少理解錯誤。

文件應盡可能地被視為代碼進行管理：

- **版本控制：** 文件應置於版本控制之下，最好與其描述的源代碼並存。
- **清晰所有權：** 文件必須有明確的所有者，避免文件過時或難以維護。
- **工作流程整合：** 文件變更應利用現有的開發人員工作流程（例如，代碼審查工具、錯誤追蹤系統）來處理。
- **持續評估：** 文件應接受審查、追蹤問題（如同追蹤代碼錯誤），並定期評估其準確性和時效性。

#### 案例分析：Google Wiki 的轉型

在 Google 早期，資訊主要透過內部 Wiki（GooWiki）分享。然而，隨著公司規模擴大，Wiki 暴露出嚴重問題：

- **所有權缺乏：** 文件沒有明確所有者，導致大量內容過時。
- **重複和混亂：** 由於缺乏流程控制，出現了大量重複文檔（例如，關於 Borg 生產計算環境的設置文檔多達 7 到 10 個）。
- **修復困難：** 能夠修復文檔的專家往往不需要參考這些文檔；而使用文檔的新手或外人不知道如何修復或向誰報告錯誤。

最終，Google 將重要文件從 Wiki 移至**源代碼控制**之下（例如使用 Markdown 格式和 `g3doc` 框架），並賦予其所有者和審查流程。這使得文檔維護變得與代碼維護一樣，大大提高了文檔品質。

### 4. 了解你的讀者（Know Your Audience）

工程師在撰寫文件時常犯的重大錯誤是**只為自己寫作**。當組織擴大時，這種假設的成本會變高。

在開始撰寫前，必須確定目標受眾，例如：經驗水平（新手或專家）、領域知識（團隊成員或外部 API 消費者）或目的。

我們通常將讀者分為兩大類型：

|讀者類型|特徵|關鍵需求|
|:--|:--|:--|
|**尋求者（Seekers）**|知道自己想要什麼，只確認資訊是否符合需求。|**一致性（Consistency）**，以便快速掃描參考資料。|
|**摸索者（Stumblers）**|對如何實作只有模糊概念，需要總覽或介紹。|**清晰度（Clarity）**，需要文檔開頭即闡明目的。|

此外，API 文件應將**客戶（Customer）**（API 用戶）與**提供者（Provider）**（項目團隊成員）的資訊區分開，例如實作細節不應暴露給最終用戶。

### 5. 文件類型（Documentation Types）

文件應具備**單一目的**，避免將多種資訊雜糅在同一文檔中（如早期 Google 常見的、包含了 API 參考、概念介紹和過時連結的「一站式」Wiki 頁面）。

主要的工程文件類型包括：

1. **參考文件（Reference Documentation）：** 最常見，記錄代碼的使用方法。
    - **API 註釋：** 旨在為 API 使用者服務，不應討論實作細節或設計決策。
    - **實作註釋：** 假定讀者具備領域知識，應解釋代碼的寫作方式和原因。
    - 在 Google，函數註釋應以**指示性動詞**開頭（例如：`Merges`、`Deletes`），確保尋求者可以透過快速掃描動詞來判斷函數功能。
2. **設計文檔（Design Docs）：** 描述大型項目的設計目標、實作策略和關鍵決策。
    - 通常需要在撰寫代碼前經過審批和討論，類似於**預先的代碼審查**。
    - 好的設計文檔會涵蓋替代方案及其優缺點，並作為項目目標的歷史記錄和衡量標準。
3. **教學（Tutorials）：** 旨在引導新人快速上手，建立「Hello World」體驗。
    - 建議在初次學習新系統時撰寫教學，以捕捉所有必需的步驟和錯誤。
    - 應將所有原子性的使用者操作合併為單一步驟，並清楚標示輸入和輸出。
4. **概念文件（Conceptual Documentation）：** 提供 API 或系統的總覽和見解，而非取代參考資料。
    - 概念文件旨在傳授**理解（understanding）**，可以為了清晰度而犧牲部分完整性或嚴格準確性。
5. **登陸頁面（Landing Pages）：** 用作團隊或產品的導航入口。應避免將團隊內部資訊與客戶所需的 API 資訊混雜在一起。

### 6. 文件審查（Documentation Reviews）

如果想「測試」文件是否有效，就必須讓其他人審查它。技術文檔通常受益於三種不同類型的審查：

1. **技術審查（Technical Review）：** 確保準確性，通常由主題專家（SME）執行。
2. **受眾審查（Audience Review）：** 確保清晰度，通常由不熟悉該領域的人（例如新團隊成員或客戶）執行。
3. **寫作審查（Writing Review）：** 確保一致性，通常由技術寫作人員或志願者執行。

### 7. 文件哲學與維護（Documentation Philosophy and Maintenance）

文件如同代碼一樣，應有其結構化的流程：

- **回答 5W1H：** 大多數技術文件解決的是 **HOW**（如何做），但必須在文檔開頭框架性地回答 WHO, WHAT, WHEN, WHERE, 和 WHY，來設定文檔的目的和讀者群。
- **結構與冗餘：** 所有文檔都應有開頭、中間和結尾，將內容劃分為邏輯部分。==在文件撰寫中，**冗餘（Redundancy）**通常是有益的，它有助於讀者理解並記住重要觀點。==
- **品質權衡：** 好的文件需在**完整性（Completeness）、準確性（Accuracy）和清晰度（Clarity）**之間進行權衡。例如，追求完整性可能會犧牲清晰度，而概念文件可能為了清晰度而犧牲部分準確性。
- **過時文件（Deprecating Documents）：** 就像舊代碼一樣，舊文件也會造成問題。在 Google，我們會在文件中附加**「新鮮度日期」（freshness dates）**元數據，記錄文檔上次審查的時間，並向所有者發送提醒，確保文件被定期審視和維護。

### 8. 何時需要技術寫作人員？（When Do You Need Technical Writers?）

由於技術寫作人員是稀缺資源，他們應該專注於工程師難以完成的任務：**為外部受眾或跨 API 邊界的文檔進行撰寫和審查**。

工程師通常可以很好地為自己的團隊撰寫文件，但當目標受眾發生變化時，他們需要幫助。技術寫作人員的關鍵作用是挑戰工程師團隊對其專案效用的假設，並以不熟悉該領域的人的角度進行寫作。將技術寫作人員用於單一團隊的內部文檔，是一種不具備規模效益的資源浪費。

### 總結（Conclusion and TL;DRs）

雖然 Google 在文件品質上已取得長足進步，但文件仍然不是如同測試一樣的「一等公民」。這是因為測試可以被自動化和原子化，而文件本質上具有主觀性，且品質的衡量往往是異步的。

然而，對於任何預期壽命超過幾個月的代碼而言，花費額外的時間來撰寫和維護文件，最終不僅能幫助他人，也能減少代碼自身的維護成本。

**要點回顧（TL;DRs）**：

- 文件對代碼的長久時間和規模至關重要。
- 文件的變更應利用現有的開發人員工作流程（如代碼審查）。
- 文件應專注於單一目的。
- 撰寫文件時，必須為您的目標受眾服務，而不是僅為自己服務。